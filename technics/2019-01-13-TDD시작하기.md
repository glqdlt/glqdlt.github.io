---
layout: post
title:  "TDD 시작하기(작성 중)"
author: "glqdlt"
---

아래는 TDD 방법론을 사내에 공유했던 내용을 정리한 아티클입니다.

## TDD 란?

> Clean code that woarks (잘 동작하는 깔끔한 코드) - Ron Jeffries(론 제프리)

> Test the program before you write it(프로그램을 작성하기 전에 테스트를 먼저 작성하는 것) - Kent Beck(켄트 백)

TDD에서 말하는 테스트와 전통적인 테스트 방법론에서 이야기하는 단위 테스트는 조금 차이가 있습니다. TDD에서의 단위 테스트는 함수(기능적) 단위의 테스트를 뜻하고, 전통적인 방법론에서는 사용자 측면에서 제품의 기능 테스트에 가깝습니다. 

예를 들어 로그인을 한다는 행위를 놓고 두 방법론을 비교해본다면 전통적인 방법론에서의 단위 테스트는 '로그인 입력 창에 ID/PW 를 입력하고, 버튼을 누르고 로그인 성공 화면을 기다린다' 까지가 되며 TDD 방법론 에서는 ID 와 PW 의 Validation 을 담당하는 기능의 테스트, 버튼이 제대로 Submit 되는지의 테스트, 로그인 성공 후의 응답 테스트 등이 있을 수 있습니다.


테스트 코드는 매우 중요합니다. 임베디드 엔지니어링을 두고 설명해보면, 기본적으로 하드웨어는 제품이 동작하기 전에 사전 테스트를 수행하고 제품의 가동여부를 판단한 후 가동시킵니다. 예를 들어 컴퓨터에서 핵심 부품 인 메인보드의 경우 램 슬롯에 램이 잘 장착됬는 지, CPU는 장착되었는 지 등을 사전 테스트하고 실패시에는 비프음과 함께 컴퓨터 파워를 차단시키고 구동을 멈추게 합니다. 만약 위와 같은 테스트 검증 과정이 없다면, 의도치 않은 동작이나 또는 더 굉장하고 끔찍한 상황을  마주할 수도 있게 될테니깐요.


> "최대한 빨리 실패하기" TDD는 실패를 통해 배움을 늘려가는 기법이다. OK 조건을 사전에 정해두고 빠르게 실패를 경험하며, 조건을 등대로 삼아 실패 상황을 최대한 빨리 극복하고자 노력한다. - 테스트 주도 개발 : 고품질 쾌속개발을 위한 TDD 실처법과 도구

> 우리는 흔히 클래스를 설계할 때 속성(필드:멤버변수)에 집중해서 설계 하는 경향이 있다. ... 클래스를 정의할 때 중요한 건 '속성' 이 아니라 '동작(메소드)' 이다. 동작을 먼저 정의하고, 동작에 필요한 속성을 고려한다 는 식으로 접근하는 편이, 불필요한 속성이 클래스 내에 섞여 들어가는 걸 줄여준다. - 테스트 주도 개발 : 고품질 쾌속개발을 위한 TDD 실처법과 도구

> "테스트에서 오류와 실패" 실패는 AssertEqauls 등의 테스트 조건식을 만족시키지 못했다는 것을 의미하고, 오류는 테스트 케이스 수행 중 예상치 못한 예외(exception)가 발생해서 테스트 수행을 멈췄다는 것을 뜻한다. 테스트 케이스가 가치를 지니기 위해서는, 어떠한 경우에도 테스트 케이스 그 자체는 정상적으로 끝까지 수행되어야 한다.  - 테스트 주도 개발 : 고품질 쾌속개발을 위한 TDD 실처법과 도구

> "여러개의 실패하는 테스트 케이스의 빠른 선언" 순수한 TDD 론에서는 실패하는 테스트를 여러 개 만들어 놓고 진행하는 걸 권장하지 않는다.


## JUnit 이름의 어원

JUnit 은 켄트백과 에릭감마가 최초로 만들었습니다. JUnit 이란 이름의 어원은 강연을 위해 애플랜타행 비행기를 타고 가던 켄트백과 에릭감마가 비행기 안에서 3시간동안 짝 프로그래밍을 한 것이 어원입니다.

> 평소 켄트 백의 SUnit(스몰토크 테스트 프레임워크)에 관심이 많던 에릭감마가 Java를 배우고자 했던 캔트백을 위해 비행기 안에서 라이브 코딩 http://members.pingnet.ch/gamma

## Java annotation 의 기원

XDoclet

## TDD 라이프사이클

<img src="http://2.bp.blogspot.com/-eMxpoJmZPwM/UvHY2BBeuHI/AAAAAAAAAwM/IvlkwTT4aGU/s1600/Picture1.gif"/>

1. 질문(ASK) == Write Failing Test == Red

    테스트의 기본 골자를 작성합니다. 해당 함수가 원하는 동작을 하는지를 체크하고 동작하기를 기대합니다.

2. 결과(Result,Response)  == Make Test Pass == Green

    테스트의 수행 결과를 확인하는 과정입니다. 성공할 수도, 실패할 수도 있습니다.

3. 정제(Refine) == Refactor == Yellow

    코드를 다듬는 과정. 실패했다면 실패한 이유를 분석하고, 성공, 실패 유무를 떠나 불필요한 것을 배제하고 모호한 것은 명확하게 하는 과정을 가집니다.

4. 반복(Repeat)

    위의 1,2,3 과정들을 한 사이클(1 cycle)로 보고, 다시 반복합니다.


## TDD 용어 정리

TDD 를 하면서 자주 접하게 되는 단어들에 대한 정리.

- 픽스처(FIXTURE)

    "일관된 테스트 실행환경"을 의미합니다. 즉, 테스트 기반이 되는 환경을 뜻 합니다.

    대부분 테스트 케이스에서 공통으로 사용 될 dummy 객체 인스턴스 등이 해당합니다.

    jUnit 에서 set up 인```@before``` 이나 tear down```@after``` 에 해당하는 메소드들을 픽스처 메소드(fixture method)라고 부릅니다.

- Stub

    Stub은 미리 준비된 응답([canned answer](https://en.wikipedia.org/wiki/Canned_response)) 혹은 정해진 대답이란 사전적인 의미를 가집니다. 예를 들자면 단어 외우기 시험과 비슷합니다. 출제 될 특정 단어들을 기재하고 실제 문제에서 해당 문제의 뜻을 작성하는 시험과 비슷하게 어떠한 것을 사전에 약속하고 질의응답을 하는 개념입니다. 
    
    (더 자세한 것은 [Test Stub 이란 무엇인가](https://medium.com/@SlackBeck/%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%8A%A4%ED%85%81-test-stub-%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80-ff9c8840c1b0) 를 참고)

    내부 메소드에 결과가 이럴 것이다 라고 기대(expected)하는 final 사수를 작성할 때, 상수 이름을 뭘로 해야할 지 고민이 됨. (https://github.com/freerange/mocha/issues/164) stub 으로 하는 게 옳다고 생각했는 데, 사실상 expected 가 더 명확한의미다 보니 이에 대한 고민이 필요한듯

- Mock

- Fake