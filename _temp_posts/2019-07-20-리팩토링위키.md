---
layout: post
title:  "리팩토링 위키"
author: "glqdlt"
---


# 분류 코드 분기를 객체지향적으로 치환

게임 회사에 재직할 떄의 이야기이다. 게임에는 많은 재화가 존재한다. 예를 들어 우리 일상생활의 돈이라는 개념이 게임에서는 게임 돈(게임머니), 현금 캐시 돈(크리스탈), 보너스 포인트 등으로 너무나도 무궁무진하게 많다. 이런 많은 재화들을 소스상에서 구별하기 위해서 일반적으로 각 게임 재화별로 특별한 인덱스 값(대부분 정수형) 부여하는 식으로 많이들 작업을 할터이다. 입사 당시 운영자가 유저의 게임재화를 선물 할 수 있는 코드는 아래의 모습이었다.

```java
    public void charge(int moneyType){

        ...

        switch(moneyType){
//            게임머니
            case 0:
                ...
                break;
//            게임 보너스 코인   
            case 1:
                ...
                break;
//            유저 결제 수정    
            case 2:
                ...
                break;
            ....
        }
        ...

    }

```

위 코드에서 switch 문에 대해서는 문제가 없다. 큰 문제는 0,1,2 가 무엇을 뜻하는 지를 주석을 보거나 옆 사람에게 물어보지 않는 이상은 명확하게 파악할 수가 없다.

```java
    public void charge(int moneyType) {

        final int GAME_MONEY = 0;
        final int GAME_COIN = 1;
        final int CRYSTAL = 2;

        if (moneyType == GAME_MONEY) {
            ...
        } else if (moneyType == GAME_COIN) {
            ...
        } else if (moneyType == CRYSTAL) {
            ...
        } else {
            throw new RuntimeException(String.format("Not Supported MonetType, '%s'", moneyType));
        }

    }
```