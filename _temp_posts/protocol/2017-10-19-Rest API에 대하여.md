
## Rest API 에 대하여..

이 글은 Naver Deview 2017 의 '그런 REST API로 괜찮겠는가?' 세션을 보고 난 후의 정리이다.


## Path variable vs Query Param

유저 ID abc 를 식별하고 디테일 정보를 얻어야할 때 아래의 2가지로 구현해볼수 있다.

case 1)
> (GET) /api/user/abc

case 2)
> (GET) /api/user?id=abc

2개의 차이점은 무엇일까?

첫번쨰 케이스는 abc 라는 유저가 존재하지 않으면 404 에러 리스펀스코드를 응답합니다. 두번쨰 케이스는 200 응답이지만 void 하거나 null 응답이 될수도 있습니다.

두 차이는 리소스가 있을수 있다를 가정하냐? 안하냐의 차이입니다.

즉 쿼리 파람의 경우 Optional 한 객체를 의미합니다. 말 그대로 옵션인 경우죠, 할수도 안할수도 있는

리액티브에서는 Maybe 모나드와 같습니다.

즉, 1번은 abc가 존재하지 않으면 에러를 throw 하는 것입니다. 존재하지 않는 리소스에 잘못된 접근인 셈입니다.

본래 웹이란 폴더에 담긴 문서를 업로드 다운로드 하기 위해 생겨난 개념입니다.

즉 위 개념으로 보면


case 1 의 경우에는 아래처럼 api 폴더 다음 user 폴더 안에 abc.txt 라는 문서가 있을거로 기대하는 것입니다.

> api \\ user \\ abc.txt 

반면 case 2 의 경우에는 아래 개념입니다.

> api \\ user.txt

user 가 폴더가 아닌 하나의 리소스이고, id = abc 라는 것은 해당 user.txt 안에서 id 라는 필드의 값이 abc 인 것을 찾는 개념입니다.



### Post vs Patch vs Put

#### POST

POST 는 객체를 새로 생성하는 개념입니다. 즉 여러번 호출하면 각기 다른 객체가 만들어집니다. new User() 를 여러번 호출한것과 같습니다.

#### PUT

PUT 은 이미 만들어졌던 기존 객체를 새로운 객체로 덮어씌우는 것을 말합니다. 즉 객체 참조 주소를 바꾸는 개념입니다.
 
교체할 리소스가 존재해야하고, 해당 객체는 PUT 을 통해 연결되는 객체로 바뀌게 됩니다.

여러번 호출해도 결과는 항상 같습니다.  즉, 멱등성입니다.


#### PATCH 

PATCH 는 이미 만들어졌던 기존 객체의 특정한 속성을 바꾸는 것을 말합니다.  PUT 은 기존 객체의 참조 주소 자체를 바꾸기에 전체를 바꾸는 것과 같으며, PATCH는 일부만을 바꾸는 개념입니다.

PATCH 는 PUT에 가까울 정도로 모든 속성을 교체한다면 멱등성을 가집니다. 다만, 일부만을 바꾸는 경우 멱등성을 보장하지 않습니다.

유저 A 는 setUserName() 을 호출하여 이름을 바꾸었던 반면, 유저 B는 setUserId() 를 호출하여 아이디를 바꾸는 PATCH 작업이 동시에 일어날 경우를 생각해보십시오.

# reference

https://tools.ietf.org/html/rfc6570#section-3.1
