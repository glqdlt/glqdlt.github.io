---
layout: post
title:  "도커기반배포파이프라인의구현"
author: "glqdlt"
comments : true
---


1. Maven Docker plugin 을 통해 아티팩트를 도커 이미지로 빌드할 수 있는 스크립트 작성

2. Jenkins 에 Item 을 등록

3. Jenkins 에서 빌드 후 private docker registery 로 push (또는 Gitlab 으로 push)

4. docker swarm 의 스케줄링을 통해 registry에 등록된 이미지를 자동으로 docker node 에 publish

https://docs.docker.com/engine/swarm/services/#placement-preferences

https://docs.docker.com/v17.09/engine/swarm/services/



https://stackoverflow.com/questions/28349392/how-to-push-a-docker-image-to-a-private-repository


### 도커 swarm 이해하기

도커 스웜은 container orchestration 의 분류에 해당하는 오케스트라레이션 tool 이다.

도커 오피셜에서는 이 스웜으로의 배포를 가이드해주고 있다. 아마 권장하는듯

https://docs.docker.com/get-started/part6/#congratulations


https://sori-nori.gitlab.io/youngkyung-done/docker-swarm/

http://www.sauru.so/blog/getting-started-with-docker-swarm/

### 도커 서비스 이해하기

서비스는 도커의 컨테이너들을 서비스 단위로 군집시켜준다는 개념으로 보면 된다.

서비스는 복제된 리플레케이션 된 확장 구성으로도 할 수 있다.


### 쿠버네티스 이해하기

쿠버네티스는 스웜과 마찬가지로 오케스트라레이션 tool 임.

https://www.popit.kr/kubernetes-introduction/

### Docker Compose 이해하기

swarm 이 고가용성이라면, 내가 원하는 단순한 저가용성은 Docker Compose 을 찾아보면 되는듯

Update

도커를 사용하면 업데이트하는 방식도 배포와 큰 차이가 없습니다.

최신 이미지를 기반으로 새 컨테이너를 만들고 이전 컨테이너를 중지(삭제)하면 됩니다. 최신 소스를 어떻게 복사할지 서버 프로세스는 어떻게 재시작할지 고민할 필요가 없습니다. 그냥 통째로 바꿔버리는 겁니다.

단, 컨테이너를 중지하지 않고 graceful스무스하게 샤샤샥 교체하는 방법은 아쉽지만 존재하지 않습니다.


https://subicura.com/2016/06/07/zero-downtime-docker-deployment.html


