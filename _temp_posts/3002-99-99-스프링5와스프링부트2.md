---
layout: post
title:  "스프링5와 스프링부트2"
author: "glqdlt"
---

스프링 5 도입을 하면서 학습한 내용을 정리한다.

자바 9 의 직소가 중요한 이유

플랫폼이 무겁다 : 특정 버전에만 포함되어야 하는 소스들을 자바 패키지에서는 정리하지 못한다. 즉, 같이 포함이 되어서  딸려간다고 용량이 10MB 만 되면 될것을 100MB 까지 늘어나는 아티팩트도 있다.

JAR 헬 : maven 에서는 기본적으로 현재 프로젝트에 정의 된 POM.xml에 먼저 선언된 버전의 디펜던시를 classpath root 에 올려놓는다. 웃긴건 디펜던시의 디펜던시에 포함된 경우에는 classpath 의 root 에 먼저 올라온 디펜던시가 메모리상에 올라가게 되어서 무시하게 된다. 예를 들면 이러하다.
Application 에서 A 모듈의 rel 2버전을 사용한다. 다만 B 모듈안의 C 모듈에서는 A 모듈 rel 1버전을 사용하고 있고, B 모듈에 포함된 C모듈에는 A rel 1버전이 포함되어있다. 이 경우 maven 에서 A모듈의 rel 2버전을 다운로드 받아서 classpath 의 root 에 A rel 2버전을 포함해서 아티팩트를 빌드하고 아카이빙(압축) 해서 jar 나 war 로 distribution 한다. 
여기서 이 application이 구동되면 A모듈의 rel 2버전이 가장 먼저 클래스 로더에 올라오게 되고, A모듈의 패키지의 클래스들을 모두 로드한다. 이후의 같은 패키지로 등록된 rel 1버전의 경우는 무시하게 된다. 이런 경우 C모듈 안에서 A rel 1버전에서 구현되었던 기능이 누락되어서 에러가 나올 수 있다.
이 경우에는 단순 명료해서 확인이 되지만, B 모듈의 경우와 같은 경우가 무수히 많다면 어떤 것이 클래스 로드에 로드가 될지 명확히 파악하기 어렵다.
직소 모듈이 구현이 된다면 위와 같은 경우를 특정 버전을 명시해서 import 할 수 있어지기에 jar 헬과같은 위험도가 대폭 낮아질 수 있다.

스프링 프레임워크5에서 삭제 된 기능

	* 
포틀린
	* 
벨로시티
	* 
제스퍼리포트
	* 
XMLBeans
	* 
JDO
	* 
구아바



구아바의 삭제가 의아해 할 수 있는 데, 구아바가 원래 생긴 취지가 자바의 부족한 기능으로 시작된 랭기지 서포트 프레임워크 였다. 구아바에서는 자바8에 구현된 람다 구분이나 스트림과 유사한 기능을 자바7에서도 사용할 수 있게 구현했었는 데, 스프링5가 자바8을 표준으로 사용하게 되면서 굳이 구아바를 의존할 필요가 없어졌다.

스프링 5에서의 새로운 기능

스프링 5은 4년 만에 처음으로 업그레이드 되는 메이저 버전이다. 가장 큰 변화는 리액티브 프로그래밍의 지원이다.

	* 
기준선 업그레이드

		* 
서블릿 3.1 이상
		* 
JMS 2.0 이상
		* 
JPA 2.1 이상
		* 
JAX-RS 2.0 이상
		* 
Bean Validation 1.1 이상
		* 
하이버네이트 5 이상
		* 
Jackson 2.6 이상
		* 
EhCache 2.10 이상
		* 
Junit 5 이상
		* 
타일즈 3 이상
		* 
톰캣 8.5 이상
		* 
제티 9.4 이상
		* 
와이드플라이 10이상
		* 
네티 4.1 이상 (웹 리액티브 프로그래밍에 사용)
		* 
언더토우 1.4 이상(웹 리액티브 프로그래밍에 사용)
	* 
JDK9 런타임 호환성 및 JDK8 사용

		* 
스프링 4.x 기본 버전은 자바6버전이었다, 자바 8버전을 기본 최소 버전으로 사용하게 되면서 람다 및 스트림을 코딩에서 사용할 수 있다. 자바8의 리플렉션 상향으로 인한 코드도 정리가 되었다.
	* 
직소를 사용한 모듈구성
	* 
리액티브 프로그래밍 지원

		* 

	* 
함수형 웹 프레임워크
	* 
코틀린 지원




스프링 부트 2.0의 새로운 기능

	* 
자바8 기본 지원
	* 
베이스 스프링은 스프링5
	* 
부트 2.0부터 웹 플럭스를 이용한 리액티브 웹 프로그래밍을 지원
	* 
서블릿 컨테이너의 최소 요구사항 제티 9.3, 톰캣 8.5
	* 
하이버네이트 5.2 최소 요구사항
	* 
그래이들 3.4 



스프링 모듈 카테고리

	1. 
스프링 코어 모듈



	* 
spring-core : 다른 스프링 모듈이 사용하는 기본 유틸리티
	* 
spring-beans 스프링 빈을 지원한다. 스프링-코어와 함께 핵심 기능인 DI 를 제공한다. BeanFactory 구현도 포함됨
	* 
spring-context : BeanFactory 를 확장하는 어플리케이션 콘텍스트를 구현한다.
	* 
spring-expression : EL(JSP 표현 언어)을 확장하고 빈 속성 액세스 및 조작을 위한 언어를 제공한다.



	1. 
스프링 AOP 모듈



재밌는 것이 테스트가 AOP 모듈 카테고리에 들어간다. 단위 테스트와 통합 테스트는 모든 계층에 적용할 수 있으므로 이 카테고리에 들어간다고 한다.

	* 
spring-aop 메서드 인터셉터와 포인트 컷을 사용한 관심지향 프로그래밍의 기본적인 지원
	* 
spring-aspects 가장 인기 있는 AOP 인 AspectJ와 통합된 모듈이다.
	* 
spring-instrument 기본적인 계측 지원을 제공
	* 
spring-test 단위 테스트 및 통합 테스트 기능 제공


	1. 
웹


	* 
spring-web : 기본적인 웹의 사양 외에 멀티-파트 파일 업로드와 같은 기능을 지원한다. 스트럿츠와 같은 다른 웹 프레임워크와의 통합도 지원한다.
	* 
spring-webmvc : 웹 MVC 모델을 스프링 프레임워크에서 구현한 모듈이다, spring-web을 확장했다. 스프링 MVC에는 REST 서비스를 구현하는 기능도 포함되어 있다.


	1. 
비지니스


비지니스 레이어는 비지니스 로직을 실행하는 데 초점을 맞춘다. 스프링 트랜잭션은 POJO(Plain Old Java Object) 및 다른 클래스에 대한 선언적 트랜잭션 관리를 제공한다.
	* 
spring-tx : 트랜잭션 관리를 지원한다.


	1. 
데이터


영속성 레이어이다. 저장에 관련 된 내용으로 RDB나 Nosql 과 같은 저장소 또는 외부의 인프라스트럭처(외부 API서버 등) 등의 인터페이스와 통신하는 기능을 담당한다.
	* 
spring-jdbc : JDBC 를 추상화한 스프링 모듈
	* 
spring-orm : ORM 프레임워크 (JPA 및 하이버네이트 : 재밌는 것은 JPA는 표준사항이고 구현체가 하이버네이트 인데, 스프링 역시 기본 사용 구현체로 하이버네이트를 사용한다.) 스펙과의 통합을 지원
	* 
spring-oxm : XML 매핑 통합을 제공한다. JAXB, Castor 등과 같은 프레임워크 지원
	* 
spring-jms : JMS를 추상화한다.



스프링프로젝트
스프링에서 가장 유명한 프로젝트는 아래와 같다.
	* 
스프링 부트

		* 
마이크로서비스 개발이 주가 된 시대에서 아래의 패러다임이 필요해졌다. 스프링 부트는 서비스 운영이 가능한 엔터프라이즈 어플리케이션 개발을 쉽고 빠르게 할 수 있도록 하자는 취지로 시작된 프로젝트이다.

			* 
프레임워크 선택 및 호환 가능한 프레임워크 버전을 결정해줌
			* 
외부화 구성을 위한 쉬운 셋팅 (한 환경에서 다른 환경으로의 마이그레이션)
			* 
어플리케이션 상태 점검 및 모니터링
			* 
배포 환경 결정 및 애플리케이션 구성
	* 
스프링 클라우드

		* 
클라우드 플랫폼 시대에 모놀리스 아키텍처에서 MSA 로의 진화는 필연이다. 스프링 클라우드는 분산 시스템의 일반적인 패턴을 위한 솔루션을 제공한다.

			* 
구성 관리
			* 
서비스 디스커버리
			* 
서킷 브레이커
			* 
지능형 라우팅
	* 
스프링 데이터

		* 
오늘날에는 많은 영속성을 위한 저장소들이 존재한다. 스프링 데이터는 다양한 사양 및 데이터 저장소와의 통합을 제공한다. 스프링 데이터의 포인트는 투명한 기능의 제공으로, 어떠한 저장소에 저장하더라도 개발자로 하여금 내부 구현체 로직을 신경쓰지 않고 사용할 수 있는 완벽한 추상화를 제공한다.

			* 
JPA (RDB)
			* 
몽고DB
			* 
레디스
			* 
Solr
			* 
Gemfire
			* 
Apache Cassandra
	* 
스프링 배치

		* 
엔터프라이즈 및 서비스 운영 환경에서의 배치 프로그램은 필수이다. 스프링 배치는 고성능 요구 사항이 있는 대용량 배치 프로그램을 위한 솔루션을 제공한다.

			* 
작업(task)의 라이프 사이클을 제어(시작,중지,재시작, 중지 된 곳부터 시작)
			* 
데이터를 chunks로 나누어서 효율적으로 처리가 가능
			* 
단계를 재시도하거나 단계를 skip 하는 기능
			* 
웹 기반 관리 인터페이스
	* 
스프링 시큐리티

		* 
엔터프라이즈 및 서비스 운영 환경에서 인증과 인가는 중요하다. 

			* 
간소화된 인증 및 권한 부여
			* 
스프링 MVC와 서블릿 API와의 통합
			* 
공통 보안 공격 방지 지원 (CSRF 및 세션 고정)
			* 
SAML 및 LDAP 과 통합 지원 모듈
	* 
스프링 HATEOAS

		* 
HATEOAS는 애플리케이션 상태 엔진인 하이퍼미디어를 나타낸다. 목표는 클라이언트(서비스 consumer) 로부터 서버(서비스 Provider) 를 분리한다. 스프링 HATEOAS는 구현체로 스프링 MVC의 REST 서비스를 구현하여 제공한다.

			* 
서비스 방법을 가리키는 링크의 단순화된 정의로 인해 링크가 깨지는 것 방지
			* 
JAXB(XML 기반)  및 JSON 통합 지원
			* 
서비스 소비자 지원






